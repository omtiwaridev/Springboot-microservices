services:
  accounts:
    image: accounts-service:1.0
    container_name: accounts
    ports:
      - "8085:8085"
    environment:
      JAVA_TOOL_OPTIONS: "-Xms256m -Xmx384m"
    deploy:
      resources:
        limits:
          memory: 512M
    networks:
      - backend
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8085/actuator/health"]
      interval: 30s
      timeout: 5s
      retries: 3

  cards:
    image: cards-service:1.0
    container_name: cards
    ports:
      - "9000:9000"
    environment:
      JAVA_TOOL_OPTIONS: "-Xms256m -Xmx384m"
    deploy:
      resources:
        limits:
          memory: 384M
    networks:
      - backend
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:9000/actuator/health"]
      interval: 30s
      timeout: 5s
      retries: 3

  loans:
    image: loans-service:1.0
    container_name: loans
    ports:
      - "8090:8090"
    environment:
      JAVA_TOOL_OPTIONS: "-Xms256m -Xmx384m"
    deploy:
      resources:
        limits:
          memory: 384M
    networks:
      - backend
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8090/actuator/health"]
      interval: 30s
      timeout: 5s
      retries: 3

networks:
  backend:
    driver: bridge
